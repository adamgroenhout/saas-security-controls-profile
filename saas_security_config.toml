# SaaS Security Configuration Baseline
# This file captures fundamental elements of good SaaS security including identity management,
# network controls, integration management, and configuration baselines.
#
# Field Definitions:
# - label: A human-readable name for the security control or setting.
# - description: A brief explanation of what the control does and why it is important.
# - enabled: Boolean (true/false) indicating if this control is currently active or enforced.
# - relevant: Boolean (true/false) indicating if this control applies to the specific environment or use case.
# - value: The current configuration setting or state for the control.
# - allowed_values: A reference list of standard options, expected formats, or valid ranges for the 'value' field.
# - exception: Boolean (true/false) indicating if a policy exception has been granted for this control.
# - exception_id: The unique identifier (e.g., ticket number, risk ID) for the approved exception, if applicable.
# - configuration_details: A sub-table containing specific, granular parameters or metadata relevant to the control.

[meta]
description = "Configuration for SaaS Security Controls"
version = "1.0"
last_updated = "2025-11-22"

# -----------------------------------------------------------------------------
# Identity and Access Management (IAM)
# -----------------------------------------------------------------------------

[iam.identity_federation]
label = "Identity Federation & SSO"
description = "Integration with external Identity Providers (IdP) for centralized authentication."
enabled = true
relevant = true
value = "saml_2_0"
allowed_values = ["saml_2_0", "oidc", "disabled"]
exception = false
exception_id = ""
configuration_details = { idp_url = "https://idp.example.com/sso", certificate_expiry = "2024-12-31" }

[iam.sso_assignment]
label = "SSO User Assignment"
description = "Policy controlling which IdP users are authorized to access the application."
enabled = true
relevant = true
value = "group_restricted"
allowed_values = ["group_restricted", "all_users"]
exception = false
exception_id = ""
configuration_details = { assignment_strategy = "rbac_mapped_groups" }

[iam.mfa_local]
label = "Multi-Factor Authentication (Local Accounts)"
description = "Requirement for MFA on accounts not managed by SSO (e.g., break-glass admins)."
enabled = true
relevant = true
value = "enforced_all"
allowed_values = ["enforced_all", "enforced_admin_only", "optional", "disabled"]
exception = false
exception_id = ""
configuration_details = { allowed_methods = ["totp", "webauthn"], grace_period_days = 0 }

[iam.least_privilege]
label = "Least Privilege Principals"
description = "Enforcement of minimal necessary permissions for users and service accounts."
enabled = true
relevant = true
value = "rbac_strict"
allowed_values = ["rbac_strict", "rbac_lenient", "manual_assignment"]
exception = false
exception_id = ""
configuration_details = { default_role = "read_only", admin_role_requires_approval = true }

[iam.account_review]
label = "Account Review Process"
description = "Frequency and enforcement of user access reviews."
enabled = true
relevant = true
value = "quarterly"
allowed_values = ["monthly", "quarterly", "semi_annually", "annually", "manual"]
exception = false
exception_id = ""
configuration_details = { auto_revoke_unused_days = 90 }

[iam.emergency_access]
label = "Emergency Access Strategy"
description = "Controls and accounts for regaining access during IdP/SSO failures."
enabled = true
relevant = true
value = "break_glass_accounts"
allowed_values = ["break_glass_accounts", "manual_fallback", "none"]
exception = false
exception_id = ""
configuration_details = { account_count = 2, credential_rotation_days = 90 }

[iam.provisioning]
label = "User Provisioning Strategy"
description = "Methodology for managing user lifecycle (creation, updates, deletion)."
enabled = true
relevant = true
value = "scim"
allowed_values = ["scim", "jit", "api_custom", "manual"]
exception = false
exception_id = ""
configuration_details = { automated_deprovisioning = true }

[iam.api_key_policy]
label = "API Key Management"
description = "Policies for the lifecycle and security of API keys."
enabled = true
relevant = true
value = "strict_rotation"
allowed_values = ["strict_rotation", "manual_audit", "disabled"]
exception = false
exception_id = ""
configuration_details = { rotation_days = 90, usage_monitoring = true }

# -----------------------------------------------------------------------------
# Network Security
# -----------------------------------------------------------------------------

[network.ip_allowlist]
label = "IP Allow Listing"
description = "Restrict access to the administration console or API to specific IP ranges."
enabled = true
relevant = true
value = ["10.0.0.0/8", "192.168.1.0/24"] # Example CIDRs
allowed_values = "List of valid CIDR strings"
exception = false
exception_id = ""
configuration_details = { enforcement_mode = "strict", bypass_for_sso = false }

[network.traffic_encryption]
label = "Traffic Encryption"
description = "Encryption standards for data in transit."
enabled = true
relevant = true
value = "tls_1_2_or_higher"
allowed_values = ["tls_1_2_or_higher", "tls_1_3", "allow_legacy"]
exception = false
exception_id = ""

# -----------------------------------------------------------------------------
# Integrations
# -----------------------------------------------------------------------------

[integrations.inventory]
label = "Integration Enumeration"
description = "Active inventory and approval of third-party integrations."
enabled = true
relevant = true
value = "allowlist_only"
allowed_values = ["allowlist_only", "monitor_only", "open"]
exception = false
exception_id = ""
configuration_details = { auto_discovery = true }

[integrations.source_ip_restrictions]
label = "Integration Source IP Restrictions"
description = "Status of source IP access restrictions for critical integrations."
enabled = true
relevant = true
# List relevant key integrations and their restriction status (true = enforced, false = not enforced)
allowed_values = "Boolean (true/false) per integration"
exception = false
exception_id = ""

[integrations.source_ip_restrictions.value]
salesforce = true
github = true
slack = false
zoom = false

[integrations.user_consent]
label = "User Consent to Apps"
description = "Controls whether users can consent to third-party applications accessing their data."
enabled = true
relevant = true
value = "disabled"
allowed_values = ["disabled", "verified_publishers_only", "open"]
exception = false
exception_id = ""
configuration_details = { admin_consent_workflow = true }

[integrations.automation_security]
label = "Automation Workflow Security"
description = "Controls for third-party automation tools and workflow connectors."
enabled = true
relevant = true
value = "managed_only"
allowed_values = ["managed_only", "restricted", "open"]
exception = false
exception_id = ""
configuration_details = { allow_zapier = false, allow_power_automate = false }

# -----------------------------------------------------------------------------
# Sharing and Collaboration
# -----------------------------------------------------------------------------

[sharing.external_collaboration]
label = "External Collaboration Settings"
description = "Controls for file sharing and collaboration with external users."
enabled = true
relevant = true
value = "authenticated_external_users_only"
allowed_values = ["authenticated_external_users_only", "restricted", "anyone_with_link", "disabled"]
exception = false
exception_id = ""
configuration_details = { expiration_policy_days = 30, allow_guest_invites = false }

# -----------------------------------------------------------------------------
# Data Security
# -----------------------------------------------------------------------------

[data.exfiltration_controls]
label = "Data Exfiltration Controls"
description = "Restrictions on mass data export and third-party backup tools."
enabled = true
relevant = true
value = "block_takeout_services"
allowed_values = ["block_takeout_services", "monitor_only", "open"]
exception = false
exception_id = ""
configuration_details = { restrict_bulk_export = true }

# -----------------------------------------------------------------------------
# Configuration Management
# -----------------------------------------------------------------------------

[configuration.baseline]
label = "Least Functionality Secure Configuration"
description = "Disabling unused services, ports, and features to minimize attack surface."
enabled = true
relevant = true
value = "strict_baseline"
allowed_values = ["strict_baseline", "standard_baseline", "custom"]
exception = false
exception_id = ""
configuration_details = { disable_unused_api_endpoints = true, remove_default_accounts = true }

# -----------------------------------------------------------------------------
# Logging and Monitoring
# -----------------------------------------------------------------------------

[logging.audit_logs]
label = "Audit Logging"
description = "Capture of security-relevant events."
enabled = true
relevant = true
value = "comprehensive"
allowed_values = ["comprehensive", "authentication_only", "disabled"]
exception = false
exception_id = ""
configuration_details = { retention_days = 365, export_to_siem = true }
