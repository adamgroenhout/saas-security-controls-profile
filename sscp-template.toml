[meta.application]
name = "Example App"
description = "Brief description of the application's purpose, key business context, and primary use cases"
url = "https://app.example.com"
business_owners = ["owner1@example.com", "owner2@example.com"]
primary_admins = ["admin1@example.com", "admin2@example.com"]
risk_classification = "high"

[meta.template]
sscp_template_version = "0.1"
# --- Field Definitions ---
description = "A brief explanation of what the control does and why it is important."
relevant = "Boolean (true/false) indicating if this control applies to and is available for the app in context."
enabled = "Boolean (true/false) indicating if this control is currently implemented."
value = "The current configuration setting or state for the control."
allowed_values = "A reference list of standard options, expected formats, or valid ranges for the 'value' field."
exception = "Boolean (true/false) indicating if a policy exception has been granted for this control."
exception_id = "The unique identifier (e.g., ticket number, risk ID) for the approved exception, if applicable."
configuration_details = "Optional parameters, settings, or metadata relevant to the control."

# -----------------------------------------------------------------------------
# Identity and Access Management
# -----------------------------------------------------------------------------

[iam.identity_federation]
description = "Integration with external Identity Providers (IdP) for centralized authentication."
relevant = true
enabled = true
value = "saml_2.0"
allowed_values = ["saml_2.0", "oidc", "disabled"]
exception = false
exception_id = ""
configuration_details = { idp_url = "https://idp.example.com/sso" }

[iam.sso_assignment]
description = "Policy controlling which IdP users are authorized to access the application."
relevant = true
enabled = true
value = "group_restricted"
allowed_values = ["group_restricted", "all_users"]
exception = false
exception_id = ""
configuration_details = { assignment_strategy = "rbac_mapped_groups" }

[iam.sso_enforcement]
description = "Disables alternative login methods (e.g. username/password) for SSO-enabled users."
relevant = true
enabled = true
value = "strict_enforcement"
allowed_values = ["strict_enforcement", "mixed_mode", "disabled"]
exception = false
exception_id = ""
configuration_details = { allow_break_glass = true, exclude_service_accounts = true }

[iam.mfa_local]
description = "Requirement for MFA on accounts not managed by SSO (e.g., break-glass admins)."
relevant = true
enabled = true
value = "enforced_all"
allowed_values = ["enforced_all", "enforced_admin_only", "optional", "disabled"]
exception = false
exception_id = ""
configuration_details = { allowed_methods = ["totp", "webauthn"], grace_period_days = 0 }

[iam.least_privilege]
description = "Enforcement of minimal necessary permissions for users and service accounts."
relevant = true
enabled = true
value = "rbac_strict"
allowed_values = ["rbac_strict", "rbac_lenient", "manual_assignment"]
exception = false
exception_id = ""
configuration_details = { default_role = "read_only", admin_role = true }

[iam.account_review]
description = "Frequency and enforcement of user access reviews."
relevant = true
enabled = true
value = "quarterly"
allowed_values = ["monthly", "quarterly", "semi_annually", "annually", "manual"]
exception = false
exception_id = ""
configuration_details = { auto_revoke_unused_days = 90 }

[iam.nhi_governance]
description = "Governance of service accounts and bots, including expiration and identification."
relevant = true
enabled = true
value = "governed_with_expiration"
allowed_values = ["governed_with_expiration", "manual", "none"]
exception = false
exception_id = ""
configuration_details = { require_expiration_date = true, identify_source_target = true, ui_access_disabled = true }

[iam.emergency_access]
description = "Controls and accounts for regaining access during IdP/SSO failures."
relevant = true
enabled = true
value = "break_glass_accounts"
allowed_values = ["break_glass_accounts", "manual_fallback", "none"]
exception = false
exception_id = ""
configuration_details = { account_count = 2, credential_rotation_days = 90 }

[iam.provisioning]
description = "Methodology for managing user lifecycle (creation, updates, deletion)."
relevant = true
enabled = true
value = "scim"
allowed_values = ["scim", "jit", "api_custom", "manual"]
exception = false
exception_id = ""
configuration_details = { automated_deprovisioning = true }

[iam.api_key_policy]
description = "Policies for the lifecycle and security of API keys."
relevant = true
enabled = true
value = "strict_rotation"
allowed_values = ["strict_rotation", "manual_audit", "disabled"]
exception = false
exception_id = ""
configuration_details = { rotation_days = 90, usage_monitoring = true }

[iam.password_policy_local]
description = "Complexity requirements for local (non-SSO) or emergency break-glass accounts."
relevant = true
enabled = true
value = "strong"
allowed_values = ["strong", "standard", "weak"]
exception = false
exception_id = ""
configuration_details = { min_length = 14, require_symbols = true, require_numbers = true }

[iam.session_idle_timeout]
description = "Time of inactivity before the application automatically terminates the session."
relevant = true
enabled = true
value = 30
allowed_values = [15, 30, 60]
exception = false
exception_id = ""
configuration_details = ""

[iam.session_absolute_lifetime]
description = "Maximum duration of a session regardless of activity (forces token refresh)."
relevant = true
enabled = true
value = 14
allowed_values = [1, 7, 14, 30]
exception = false
exception_id = ""
configuration_details = ""

[iam.conditional_access_enforcement]
description = "Enforcement of contextual security signals (Device, Location, Risk) during authentication."
relevant = true
enabled = true
value = "idp_enforced"
allowed_values = ["idp_enforced", "native_ip_restriction", "disabled"]
exception = false
exception_id = ""
configuration_details = { require_managed_device = true, require_compliant_os = true, block_impossible_travel = true, block_high_risk_users = true, require_phishing_resistant_mfa = true, require_mfa_at_sign_in = true }

[iam.ip_allowlist]
description = "Restrict user access to the admin console and/or API to specific IP ranges."
relevant = true
enabled = true
value = ["10.0.0.0/8", "192.168.1.0/24"]
allowed_values = "List of valid CIDR strings"
exception = false
exception_id = ""
configuration_details = { enforcement_mode = "strict", bypass_for_sso = false }

# -----------------------------------------------------------------------------
# Integrations
# -----------------------------------------------------------------------------

[integrations.user_consent]
description = "Controls whether users can consent to third-party applications accessing their data."
relevant = true
enabled = true
value = "disabled"
allowed_values = ["disabled", "verified_publishers_only", "open"]
exception = false
exception_id = ""
configuration_details = { admin_consent_workflow = true }

[integrations.automation_security]
description = "Controls for third-party automation tools and workflow connectors."
relevant = true
enabled = true
value = "managed_only"
allowed_values = ["managed_only", "restricted", "open"]
exception = false
exception_id = ""
configuration_details = { allowed_apps = ["app5", "app6"] }

# --- Connected Apps ---

[integrations.connected_apps]
description = "Security configuration for external application connections, including account scoping, type, and network restrictions."
relevant = true
enabled = true
# Configuration consists of integration names mapped to their security attributes
allowed_values = "Integration entries (e.g. app1, app2) with attributes: account_type ('dedicated', 'shared'), ip_restrictions (boolean), least_privileged (boolean)"
exception = false
exception_id = ""
configuration_details = ""

[integrations.connected_apps.app1]
account_type = "shared"
ip_restrictions = true
least_privileged = true

[integrations.connected_apps.app2]
account_type = "dedicated"
ip_restrictions = true
least_privileged = false

[integrations.connected_apps.app3]
account_type = "shared"
ip_restrictions = false
least_privileged = false

[integrations.connected_apps.app4]
account_type = "dedicated"
ip_restrictions = false
least_privileged = true

# -----------------------------------------------------------------------------
# Sharing and Collaboration
# -----------------------------------------------------------------------------

[sharing.external_collaboration]
description = "Controls for file sharing and collaboration with external users."
relevant = true
enabled = true
value = "authenticated_external_users_only"
allowed_values = ["authenticated_external_users_only", "restricted", "anyone_with_link", "disabled"]
exception = false
exception_id = ""
configuration_details = { expiration_policy_days = 30, allow_guest_invites = false }

[sharing.public_link_restriction]
description = "Prevents users from creating public, anonymous links (e.g., 'Anyone with the link')."
relevant = true
enabled = true
value = "internal_only"
allowed_values = ["internal_only", "specific_people", "public_with_expiry"]
exception = false
exception_id = ""
configuration_details = ""

[sharing.external_domain_restriction]
description = "Restricts external sharing to specific allowed domains or blocks specific denied domains."
relevant = true
enabled = true
value = "allowlist_only"
allowed_values = ["allowlist_only", "denylist_only", "open"]
exception = false
exception_id = ""
configuration_details = { allowed_domains = ["partner.com", "vendor.com"], denied_domains = ["competitor.com", "public-email.com"] }

# -----------------------------------------------------------------------------
# Data Security
# -----------------------------------------------------------------------------

[data.exfiltration_controls]
description = "Restrictions on mass data export and third-party backup tools."
relevant = true
enabled = true
value = "block_takeout_services"
allowed_values = ["block_takeout_services", "monitor_only", "open"]
exception = false
exception_id = ""
configuration_details = { restrict_bulk_export = true }

[data.classification]
description = "Enforcement of data tagging and classification labels."
relevant = true
enabled = true
value = "automated_enforcement"
allowed_values = ["automated_enforcement", "manual", "none"]
exception = false
exception_id = ""
configuration_details = { default_label = "internal", require_label_on_download = true }

[data.encryption_at_rest]
description = "Encryption standards for data stored within the SaaS provider."
relevant = true
enabled = true
value = "provider_managed"
allowed_values = ["provider_managed", "customer_managed_keys", "none"]
exception = false
exception_id = ""
configuration_details = { key_rotation_days = 365 }

# -----------------------------------------------------------------------------
# Configuration Management
# -----------------------------------------------------------------------------

[configuration.least_functionality]
description = "Disabling unused services and features to minimize attack surface."
relevant = true
enabled = true
value = "strict_baseline"
allowed_values = ["strict_baseline", "standard_baseline", "custom"]
exception = false
exception_id = ""
configuration_details = { disable_unused_api_endpoints = true, remove_default_accounts = true }

# -----------------------------------------------------------------------------
# Logging and Monitoring
# -----------------------------------------------------------------------------

[logging.audit_logs]
description = "Capture of security-relevant events."
relevant = true
enabled = true
value = "comprehensive"
allowed_values = ["comprehensive", "authentication_only", "disabled"]
exception = false
exception_id = ""
configuration_details = { retention_days = 365, export_to_siem = true }
